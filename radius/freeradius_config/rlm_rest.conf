rest {
    # Configure the REST module to use our API endpoints
    tls {
        # If using HTTPS, configure TLS settings here
    }

    # Default connection pool settings
    connect_uri = "http://localhost:8000"
    connect_timeout = 5.0
    read_timeout = 5.0
    
    # Configure authorization request
    authorize {
        uri = "${..connect_uri}/api/radius/authorize"
        method = "post"
        body = "json"
        data = '{"request_type": "authorize", "username": "%{User-Name}"}'
        tls = ${..tls}
    }
    
    # Configure authentication request
    authenticate {
        uri = "${..connect_uri}/api/radius/authenticate"
        method = "post"
        body = "json"
        data = '{"request_type": "authenticate", "username": "%{User-Name}", "password": "%{User-Password}"}'
        tls = ${..tls}
    }
    
    # Configure accounting request
    accounting {
        uri = "${..connect_uri}/api/radius/accounting"
        method = "post"
        body = "json"
        data = '{"request_type": "accounting", "username": "%{User-Name}", "acct_status_type": "%{Acct-Status-Type}", "acct_session_id": "%{Acct-Session-Id}", "acct_session_time": "%{Acct-Session-Time}", "acct_input_octets": "%{Acct-Input-Octets}", "acct_output_octets": "%{Acct-Output-Octets}", "acct_input_gigawords": "%{Acct-Input-Gigawords}", "acct_output_gigawords": "%{Acct-Output-Gigawords}", "acct_terminate_cause": "%{Acct-Terminate-Cause}", "nas_ip_address": "%{NAS-IP-Address}", "framed_ip_address": "%{Framed-IP-Address}"}'
        tls = ${..tls}
    }
    
    # Configure post-auth request
    post-auth {
        uri = "${..connect_uri}/api/radius/authorize"
        method = "post"
        body = "json"
        data = '{"request_type": "post-auth", "username": "%{User-Name}"}'
        tls = ${..tls}
    }
} 